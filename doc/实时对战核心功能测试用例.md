### **  实时对战核心功能测试用例**

#### **A. 核心战斗场景 (Core Combat Scenarios)**

这部分用例专注于验证 CombatManager 的碰撞和击杀逻辑。

|          |                                                                                                                                                                                 |
| -------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 用例ID     | **TC-COMBAT-01: 实体对撞 - 同归于尽**                                                                                                                                                   |
| **测试目标** | 验证两个实体移动单位（如车）迎头相撞时，会正确触发双亡逻辑，且视觉表现一致。                                                                                                                                          |
| **前置条件** | 1. 游戏模式为“实时对战”。<br>2. 棋盘开局，或清空棋盘中路，仅在(0,0)保留红车，(0,9)保留黑车。<br>3. 双方均有至少1点行动点。                                                                                                    |
| **操作步骤** | 1. 红方操作车(0,0)移动至(0,9)。<br>2. **几乎同时**，黑方操作车(0,9)移动至(0,0)。                                                                                                                       |
| **预期结果** | 1. **日志：** 打印“[Combat-Enemy] 碰撞双亡！”日志。<br>2. **逻辑：** 两个车的RTState.IsDead都应为true。<br>3. **视觉：** 两个车的GameObject在碰撞点附近**双双消失**。<br>4. **事件：** GameManager应收到两个OnPieceKilled事件并正确处理。 |

|   |   |
|---|---|
|用例ID|**TC-COMBAT-02: 移动中捕获 - 常规吃子**|
|**测试目标**|验证一个移动单位能够正确“吃掉”一个在其移动路径终点的**静止**敌方单位。|
|**前置条件**|1. 红车位于(4,0)，黑兵位于(4,3)。<br>2. 红方有至少1点行动点。|
|**操作步骤**|1. 红方操作车(4,0)移动至黑兵所在的(4,3)格。|
|**预期结果**|1. **逻辑：** 当红车的移动动画完成时，黑兵被判定为死亡。<br>2. **视觉：** 红车移动到(4,3)，黑兵的GameObject消失。<br>3. **模型：** BoardState在(4,3)的位置最终应为红车。|

|   |   |
|---|---|
|用例ID|**TC-COMBAT-03: 虚实交互 - 落地狙杀**|
|**测试目标**|验证虚无移动单位（如马）的**无敌窗口**和**落地脆弱期**。|
|**前置条件**|1. 红马位于(1,0)，黑车位于(3,1)。<br>2. 双方均有至少1点行动点。|
|**操作步骤**|**场景一 (穿行无伤):**<br>1. 红方操作马(1,0)移动至(2,2)。<br>2. 在红马移动到一半时，黑方操作车(3,1)横向移动至(0,1)，使其路径与红马路径交叉。<br>**场景二 (落地击杀):**<br>1. 红方操作马(1,0)移动至(2,2)。<br>2. 黑方**预判**并操作车(3,1)移动至(2,2)，使其与红马**几乎同时到达**。|
|**预期结果**|**场景一:**<br>1. 红马和黑车应互相穿过，**不发生任何碰撞或伤害**。<br>**场景二:**<br>1. **日志：** 打印黑车击杀红马的日志。<br>2. **逻辑/视觉：** 红马在即将到达终点时被摧毁，黑车存活并完成移动。|

|   |   |
|---|---|
|用例ID|**TC-COMBAT-04: 友军碰撞 - 价值裁决**|
|**测试目标**|验证友方单位碰撞时，会根据PieceValue正确裁决，价值低者被摧毁。|
|**前置条件**|1. 红车位于(0,0)，红兵位于(0,3)。<br>2. 红方有至少2点行动点。|
|**操作步骤**|1. 红方操作车(0,0)移动至(0,9)。<br>2. **几乎同时**，红方操作兵(0,3)移动至(0,0)。|
|**预期结果**|1. **日志：** 打印“[Combat-Friendly] 友方碰撞！”及“价值更高”的裁决日志。<br>2. **逻辑/视觉：** 红兵被摧毁，红车继续移动。|

---

#### **B. 状态与特殊逻辑 (State & Special Logic)**

这部分用例专注于验证实时状态变化和特殊棋子的规则。

|   |   |
|---|---|
|用例ID|**TC-STATE-01: 动态炮架 - 实时高亮**|
|**测试目标**|验证炮的合法移动高亮会根据其他棋子的实时移动而动态变化。|
|**前置条件**|1. 红炮位于(1,2)，黑兵位于(1,6)，黑车位于(1,9)。中间(1,4)为空。|
|**操作步骤**|1. 红方选中炮(1,2)。<br>2. **观察：** 此时黑车(1,9)位置应有攻击高亮（隔着黑兵）。<br>3. 黑方操作兵(1,6)向旁边移动至(2,6)。<br>4. **再次观察：** 在黑兵离开(1,6)的瞬间，红炮对黑车的攻击高亮应**立即消失**。|
|**预期结果**|1. 选中炮时，其攻击高亮会随着“炮架”棋子的移动而**实时、正确地更新**。|

---

#### **C. 资源与输入 (Resource & Input)**

|   |   |
|---|---|
|用例ID|**TC-RESOURCE-01: 能量耗尽 - 操作限制**|
|**测试目标**|验证当行动点为0时，玩家无法选择或移动棋子。|
|**前置条件**|1. 红方行动点为0.5（小于1）。|
|**操作步骤**|1. 尝试点击任意一个红方棋子。<br>2. 等待行动点恢复到1.2。<br>3. 再次点击同一个红方棋子。|
|**预期结果**|1. **步骤1：** 点击无效，棋子未被选中，日志打印“行动点不足”。<br>2. **步骤3：** 点击有效，棋子被成功选中，并显示合法移动高亮。|

---

#### **D. 胜负条件 (Win/Loss Condition)**

|   |   |
|---|---|
|用例ID|**TC-WIN-01: 击杀主帅 - 游戏结束**|
|**测试目标**|验证任意一方的将/帅被击杀后，游戏会立刻正确地结束。|
|**前置条件**|1. 将红车放在黑帅(4,9)的攻击路径上，例如(4,0)。<br>2. 红方有足够行动点。|
|**操作步骤**|1. 红方操作车(4,0)移动并吃掉黑帅(4,9)。|
|**预期结果**|1. **日志：** 打印游戏结束日志，结果为“RedWin”。<br>2. **状态：** GameManager.isGameEnded 变为 true。<br>3. **输入：** 游戏内所有棋子均无法再被操作。|

---