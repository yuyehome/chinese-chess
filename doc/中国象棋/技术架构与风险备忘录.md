# 技术架构与风险备忘录

## 1. 核心技术栈

- **客户端:** Unity (C#)
- **网络 (初期):** Steamworks P2P (推荐通过`Mirror`或`Fish-Networking`等高层网络库集成)。
- **网络 (后期):** 自建专用服务器 (Headless Unity / C# / Go)。
- **服务器API (初期):** Node.js (Express.js) - 轻量、高效，可通过AI辅助开发。
- **数据库 (初期):** MySQL - 部署在同一台ECS上。
- **服务器部署 (初期):** 单台低配云服务器ECS (1核2G/2核4G)，同时部署Node.js API和MySQL。

## 2. 关键技术问题与解决方案

### 2.1. 网络同步
- **问题:** 状态不同步(Desync)、延迟下的操作不流畅。
- **方案:**
  - **权威主机:** P2P模式下，房主客户端作为唯一权威，所有逻辑计算在此发生。
  - **状态同步:** 主机定期（或在状态变化时）广播游戏世界快照给客户端。
  - **客户端预测:** 客户端立即执行本地玩家操作并显示，等待服务器状态进行校正（Reconciliation）。
  - **插值(Interpolation):** 客户端在两个网络快照之间平滑地渲染物体移动，避免卡顿。

### 2.2. 数据存储与迁移
- **问题:** 如何在无服务器时安全存储玩家数据，以及未来如何迁移。
- **方案:**
  - **初期架构:** `客户端` -> `Node.js API` -> `MySQL数据库`。客户端通过SteamID向API验证身份。
  - **数据库选型:** 初期在ECS上自建MySQL。用户量增长后，平滑迁移到云数据库服务(RDS)。
  - **数据安全:** **严禁客户端直连数据库。** 所有数据库操作必须通过服务器API进行。

### 2.3. AI辅助开发
- **你的角色:** 系统架构师、核心模块开发者、代码评审员、集成工程师。
- **AI的角色:** 代码生成器、文档查询器、单元测试助手、美术素材生成器。
- **工作流:** 你定义架构和接口 -> AI填充具体实现 -> 你审查、集成和调试。

## 3. 主要项目风险与应对策略

| 风险类别 | 风险描述 | 应对策略 |
| :--- | :--- | :--- |
| **技术风险** | 网络同步问题比预想中复杂，耗费大量时间。 | - 使用成熟的高层网络库(Mirror/Fish-Net)。<br>- 在项目最早阶段就搭建网络原型进行测试。 |
| **设计风险** | 游戏平衡性难以调整，导致玩法体验差。 | - 尽早通过EA版本收集大量玩家对战数据。<br>- 关键参数（行动点恢复速度等）做成可在线热更新的配置。 |
| **市场风险** | 原作者/其他竞争者抢先发布高质量版本。 | - 采取“后发制人”策略，专注打磨产品质量和差异化（技能、布阵）。<br>- 建立自己的开发者社区，积累核心粉丝。 |
| **个人风险** | “虎头蛇尾”，因困难或孤独感而中途放弃。 | - 严格遵守版本规划，抵制“范围蔓延”。<br>- **公开开发日志**（B站/知乎），建立外部监督和正反馈循环。 |
